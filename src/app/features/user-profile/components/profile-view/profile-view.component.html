<div class="container mx-auto px-4 py-6 md:py-8">
  <h1 class="text-3xl font-bold mb-6">Thông tin tài khoản</h1>

  <!-- Loading -->
  <div *ngIf="isLoading()" class="text-center py-10">
    <span class="loading loading-spinner loading-lg text-primary"></span>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage()" class="alert alert-error shadow-lg mb-6">
    <!-- ... (icon và message lỗi) ... -->
    <span>Lỗi: {{ errorMessage() }}</span>
  </div>

  <!-- Profile Details -->
  <div *ngIf="profile() && !isLoading()" class="card bg-base-100 shadow-xl lg:card-side"> <!-- card-side trên lg -->
    <!-- Avatar Section -->
    <figure class="p-6 flex justify-center lg:w-1/4">
      <div class="avatar">
        <div class="w-32 lg:w-40 rounded-full ring ring-primary ring-offset-base-100 ring-offset-2">
          <img [src]="profile()?.avatarUrl || 'assets/images/default-avatar.png'" alt="Avatar" />
        </div>
      </div>
    </figure>

    <!-- Info Section -->
    <div class="card-body lg:w-3/4">
      <div class="flex flex-col sm:flex-row justify-between items-start mb-4">
        <div>
          <h2 class="card-title text-2xl mb-1" [textContent]="profile()?.fullName"></h2>
          <p class="text-base-content/70" [textContent]="profile()?.email"></p>
          <p class="text-base-content/70">Số điện thoại: <span [textContent]="profile()?.phoneNumber || 'Chưa cập nhật'"></span></p>
          <p class="text-base-content/70">Ngày tham gia: <span [textContent]="profile()?.createdAt | date:'dd/MM/yyyy'"></span></p>
          <p class="mt-2">Vai trò:
            <span *ngFor="let role of profile()?.roles" class="badge badge-primary badge-outline ml-1">
              {{ role.replace('ROLE_', '') }}
            </span>
          </p>
        </div>
        <!-- Actions -->
        <div class="mt-4 sm:mt-0 flex flex-col sm:flex-row sm:items-center gap-2">
          <a routerLink="/user/profile/edit" class="btn btn-sm btn-outline btn-primary w-full sm:w-auto">Chỉnh sửa</a>
          <a routerLink="/user/profile/change-password" class="btn btn-sm btn-outline w-full sm:w-auto">Đổi mật khẩu</a>
        </div>
      </div>

      <!-- Farmer Profile -->
      <div *ngIf="profile()?.farmerProfile as farmerProfile" class="mt-4 pt-4 border-t border-base-300">
        <h3 class="text-lg font-semibold mb-2">Thông tin Nông dân</h3>
        <!-- ... (hiển thị thông tin farmer như trước) ... -->
        <div class="mt-3">
          <a routerLink="/user/profile/farmer-profile" class="btn btn-sm btn-link px-0">Xem/Sửa hồ sơ Nông dân</a>
          <a routerLink="/farmer/dashboard" class="btn btn-sm btn-link px-0 ml-4">Vào Kênh người bán</a>
        </div>
      </div>

      <!-- Business Profile -->
      <div *ngIf="profile()?.businessProfile as businessProfile" class="mt-4 pt-4 border-t border-base-300">
        <h3 class="text-lg font-semibold mb-2">Thông tin Doanh nghiệp</h3>
        <!-- ... (hiển thị thông tin business như trước) ... -->
        <div class="mt-3">
          <a routerLink="/user/profile/business-profile" class="btn btn-sm btn-link px-0">Xem/Sửa hồ sơ Doanh nghiệp</a>
        </div>
      </div>

      <!-- Register Links -->
      <div *ngIf="isConsumerOnly()" class="mt-6 pt-6 border-t border-base-300 grid grid-cols-1 md:grid-cols-2 gap-4">
        <div class="card bg-base-200 p-4">
          <h3 class="font-semibold mb-1">Bạn là Nông dân?</h3>
          <p class="text-sm text-base-content/70 mb-3">Đăng ký gian hàng để bán nông sản của bạn.</p>
          <a routerLink="/user/profile/farmer-profile" class="btn btn-sm btn-success self-start">Đăng ký bán hàng</a>
        </div>
        <div class="card bg-base-200 p-4">
          <h3 class="font-semibold mb-1">Mua hàng cho Doanh nghiệp?</h3>
          <p class="text-sm text-base-content/70 mb-3">Đăng ký tài khoản B2B để nhận ưu đãi.</p>
          <a routerLink="/user/profile/business-profile" class="btn btn-sm btn-info self-start">Đăng ký Doanh nghiệp</a>
        </div>
      </div>

    </div>
  </div>
</div>
